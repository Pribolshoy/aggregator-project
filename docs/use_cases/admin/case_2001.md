# Пользовательский сценарии 2001

<table>
    <tr>
        <td>Действующие лица</td>
        <td>Администратор, Система</td>
    </tr>
    <tr>
        <td>Цели</td>
        <td>
        Администратор: 
            <br>Зайти в админку, запустить обновление предложений поставщика, получить уведомление.
        <br><br>
        Система: 
            <br>Выполнить прасинг и обновление в асинхронном режиме и по окончании сформировать уведомление.
        </td>
    </tr>
    <tr>
        <td>Успешный сценарий</td>
        <td>
1. Администратор заходит в админ панель через веб браузер<br>
2. Администратор в панели фильтрации выбирает нужного поставщика и категорию предложений, нажимает кнопку запуска<br>
3. Система формирует сообщение и отправляет в очередь<br>
4. Консумер отвечающий за парсинг забирает сообщение из очереди и запускает процесс парсинга<br>
5. Перед началом парсинга в БД записывается история о начале парсинга<br>
6. По завершению парсинга формируются ресурсы в виде файлов xml и сохраняются в общем файловом хранилище, обновляется запись в БД.<br>
7. Система формирует сообщение для обновления спарсенных товаров и отправляет в очередь.<br>
8. Консумер отвечающий за обновление предложений забирает сообщение из очереди и запускает процесс обновления через переданный ID сформированного при парсинге файла<br>
9. По завершению обновления, запись в БД сделанная на 5 шаге помечается как завершенная и формируется сообщение для оповещения пользоватея<br>
10. Консумер отвечающий за оповещение забирает сообщение из очереди и запускает процесс передачи оповещения во внешний сервис<br>
11. Администратор получает уведомление о том что парсинг и обновление завершено<br>

</table>

![UML](./uml.png)